<!-- build time:Mon Oct 31 2022 11:09:52 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="永不陨落的星辰" href="https://www.yexingcheng.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="永不陨落的星辰" href="https://www.yexingcheng.com/atom.xml"><link rel="alternate" type="application/json" title="永不陨落的星辰" href="https://www.yexingcheng.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="react"><link rel="canonical" href="https://www.yexingcheng.com/react-study/8/"><title>React学习第八天 - react学习 | 永不陨落的星辰 = 永不陨落的星辰</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">React学习第八天</h1><div class="meta"><span class="item" title="创建时间：2022-08-08 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-08-08T00:00:00+08:00">2022-08-08</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>34k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>31 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">永不陨落的星辰</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gipevgoki5j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicit4jrvuj20zk0m8785.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicmnywqgpj20zk0m8dwx.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giph4lm9i7j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclj9410cj20zk0m8h12.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclhtuo6nj20zk0m8ttm.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/react-study/" itemprop="item" rel="index" title="分类于 react学习"><span itemprop="name">react学习</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.yexingcheng.com/react-study/8/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="叶星辰"><meta itemprop="description" content=", 温柔正确的人总是难以生存，因为这个世界既不温柔 也不正确"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="永不陨落的星辰"></span><div class="body md" itemprop="articleBody"><h1 id="十八-redux"><a class="anchor" href="#十八-redux">#</a> 十八、Redux</h1><h2 id="181-理解flux架构"><a class="anchor" href="#181-理解flux架构">#</a> 18.1 理解 Flux 架构</h2><p>在 2013 年，Facebook 让 <code>React</code> 亮相的同时推出了 Flux 框架， <code>React</code> 的初衷实际上是用来替代 <code>jQuery</code> 的， <code>Flux</code> 实际上就可以用来替代 <code>Backbone.js</code> ， <code>Ember.js</code> 等一系列 <code>MVC</code> 架构的前端 JS 框架。</p><p>其实 <code>Flux</code> 在 <code>React</code> 里的应用就类似于 <code>Vue</code> 中的 <code>Vuex</code> 的作用，但是在 <code>Vue</code> 中， <code>Vue</code> 是完整的 <code>mvvm</code> 框架，而 <code>Vuex</code> 只是一个全局的插件。</p><p><code>React</code> 只是一个 MVC 中的 V (视图层)，只管页面中的渲染，一旦有数据管理的时候， <code>React</code> 本身的能力就不足以支撑复杂组件结构的项目，在传统的 <code>MVC</code> 中，就需要用到 Model 和 Controller。Facebook 对于当时世面上的 <code>MVC</code> 框架并不满意，于是就有了 <code>Flux</code> , 但 <code>Flux</code> 并不是一个 <code>MVC</code> 框架，他是一种新的思想。</p><p><img data-src="flux.png" alt="image-20220812002755397"></p><ul><li>View： 视图层</li><li>ActionCreator（动作创造者）：视图层发出的消息（比如 mouseClick）</li><li>Dispatcher（派发器）：用来接收 Actions、执行回调函数</li><li>Store（数据层）：用来存放应用的状态，一旦发生变动，就提醒 Views 要更新页面</li></ul><p>Flux 的流程：</p><ol><li>组件获取到 store 中保存的数据挂载在自己的状态上</li><li>用户产生了操作，调用 actions 的方法</li><li>actions 接收到了用户的操作，进行一系列的逻辑代码、异步操作</li><li>然后 actions 会创建出对应的 action，action 带有标识性的属性</li><li>actions 调用 dispatcher 的 dispatch 方法将 action 传递给 dispatcher</li><li>dispatcher 接收到 action 并根据标识信息判断之后，调用 store 的更改数据的方法</li><li>store 的方法被调用后，更改状态，并触发自己的某一个事件</li><li>store 更改状态后事件被触发，该事件的处理程序会通知 view 去获取最新的数据</li></ol><h2 id="182-理解redux单向数据流流程"><a class="anchor" href="#182-理解redux单向数据流流程">#</a> 18.2 理解 Redux 单向数据流流程</h2><p>React 只是 DOM 的一个抽象层，并不是 Web 应用的完整解决方案。有两个方面，它没涉及。</p><ul><li>代码结构</li><li>组件之间的通信</li></ul><p>2013 年 Facebook 提出了 Flux 架构的思想，引发了很多的实现。2015 年，Redux 出现，将 Flux 与<span class="exturl" data-url="aHR0cHM6Ly9sbGg5MTEwMDEuZ2l0Ym9va3MuaW8vbW9zdGx5LWFkZXF1YXRlLWd1aWRlLWNoaW5lc2UvY29udGVudC8=">函数式编程</span>结合一起，很短时间内就成为了最热门的前端架构。</p><p>如果你不知道是否需要 Redux，那就是不需要它</p><p>只有遇到 React 实在解决不了的问题，你才需要 Redux</p><p>简单说，如果你的 UI 层非常简单，没有很多互动，Redux 就是不必要的，用了反而增加复杂性。</p><ul><li>用户的使用方式非常简单</li><li>用户之间没有协作</li><li>不需要与服务器大量交互，也没有使用 WebSocket</li><li>视图层（View）只从单一来源获取数据</li></ul><p><strong>需要使用 Redux 的项目:</strong></p><ul><li>用户的使用方式复杂</li><li>不同身份的用户有不同的使用方式（比如普通用户和管理员）</li><li>多个用户之间可以协作</li><li>与服务器大量交互，或者使用了 WebSocket</li><li>View 要从多个来源获取数据</li></ul><p><strong>从组件层面考虑，什么样子的需要 Redux：</strong></p><ul><li>某个组件的状态，需要共享</li><li>某个状态需要在任何地方都可以拿到</li><li>一个组件需要改变全局状态</li><li>一个组件需要改变另一个组件的状态</li></ul><p><strong>Redux 的设计思想：</strong></p><ol><li>Web 应用是一个状态机，视图与状态是一一对应的。</li><li>所有的状态，保存在一个对象里面（唯一数据源）。</li></ol><blockquote><p>注意：flux、redux 都不是必须和 react 搭配使用的，因为 flux 和 redux 是完整的架构，在学习 react 的时候，只是将 react 的组件作为 redux 中的视图层去使用了。</p></blockquote><p><img data-src="image%5Credux" alt="image-20220812002936378"></p><h2 id="183-redux使用三大原则"><a class="anchor" href="#183-redux使用三大原则">#</a> 18.3 redux 使用三大原则</h2><ul><li>Single Source of Truth (唯一的数据源)</li><li>State is read-only (状态是只读的) - 无法直接修改状态</li><li>Changes are made with pure function (数据的改变必须通过纯函数完成)</li></ul><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>$ cnpm i redux <span class="token parameter variable">-S</span></pre></td></tr></table></figure><p><code>src/13_redux/store.js</code> 创建状态管理器</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//createStore 方法在新版本中已经被弃用</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 2. 创建所有操作 reducer 以及定义初始化的状态 - 纯函数</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 第一个参数为管理的状态，需要在此处书写 初始的状态</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'hello redux'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">10</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">//action 中 type 代表动作的标识，用于触发行为，payload 代表传递的参数</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CAHNGE_MSG'</span><span class="token operator">:</span> <span class="token comment">//type 的名字可以根据自己公司的需求进行更改</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token comment">// 必须返回最新的状态</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'INCREMENT_COUNT'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'DECREMENT_COUNT'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">-</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// 创建状态管理器</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><p><code>src/index.js</code> 配置状态管理器 - 状态管理器修改订阅视图的更新</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./13_redux/store'</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./13_redux/App'</span> </pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//dispatch 可以触发 reducer 的更改</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//getState 可以用来获取状态管理器的数据</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//replaceReducer 替换 reducer</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//subscribe 订阅数据的变化</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="19"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// 订阅数据的变化，重新渲染视图</span></pre></td></tr><tr><td data-num="24"></td><td><pre>store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token comment">// 一旦检测到数据发生改变，此处代码就会执行</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>src/13_redux/App.jsx</code> 使用状态管理器</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Child1 <span class="token keyword">from</span> <span class="token string">'./Child1'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> Child2 <span class="token keyword">from</span> <span class="token string">'./Child2'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">使用redux</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Child1</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Child2</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/13_redux/Child1.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Child1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> state <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取状态管理器中的状态</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">child1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token punctuation">&#123;</span> state<span class="token punctuation">.</span>msg <span class="token punctuation">&#125;</span><span class="token plain-text"> - </span><span class="token punctuation">&#123;</span> state<span class="token punctuation">.</span>count <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>          store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CAHNGE_MSG'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token string">'hello child1 redux'</span></pre></td></tr><tr><td data-num="14"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">></span><span class="token plain-text">修改msg</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>          store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'INCREMENT_COUNT'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token number">10</span></pre></td></tr><tr><td data-num="20"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">></span><span class="token plain-text">加10</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Child1<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/13_redux/Child2.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Child2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> state <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取状态管理器中的状态</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">child2</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token punctuation">&#123;</span> state<span class="token punctuation">.</span>msg <span class="token punctuation">&#125;</span><span class="token plain-text"> - </span><span class="token punctuation">&#123;</span> state<span class="token punctuation">.</span>count <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>          store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CAHNGE_MSG'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token string">'hello child2 redux'</span></pre></td></tr><tr><td data-num="13"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">></span><span class="token plain-text">修改msg</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="15"></td><td><pre>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>          store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'DECREMENT_COUNT'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token number">10</span></pre></td></tr><tr><td data-num="19"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">></span><span class="token plain-text">减10</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Child2<span class="token punctuation">;</span></pre></td></tr></table></figure><p>以上代码是最最最最最最最基本的 redux 的使用，现在企业里基本上不使用这种原始的方法</p><h2 id="184-redux-react-redux配合使用"><a class="anchor" href="#184-redux-react-redux配合使用">#</a> 18.4 redux + react-redux 配合使用</h2><blockquote><p>redux 是属于 js 的状态管理模式，不独属于 react，在 react 中需要结合 react-redux 模块使用</p></blockquote><p>react-redux 提供两个核心的 api：</p><ul><li><p>Provider: 提供 store <code>&lt;Provider store = &#123; store &#125;&gt;&lt;App /&gt;&lt;/store&gt;</code></p></li><li><p>connect: 用于连接容器组件和展示组件</p><ul><li><p>Provider</p><p>根据单一 store 原则 ，一般只会出现在整个应用程序的最顶层。</p></li><li><p>connect</p><p>语法格式为</p><p><code>connect(mapStateToProps?, mapDispatchToProps?, mergeProps?, options?)(component)</code></p><p>一般来说只会用到前面两个，它的作用是：</p><ul><li>把 <code>store.getState()</code> 的状态转化为展示组件的 <code>props</code></li><li>把 <code>actionCreators</code> 转化为展示组件 <code>props</code> 上的方法</li></ul></li></ul></li></ul><p>只要上层中有 <code>Provider</code> 组件并且提供了 <code>store</code> , 那么，子孙级别的任何组件，要想使用 <code>store</code> 里的状态，都可以通过 <code>connect</code> 方法进行连接。如果只是想连接 <code>actionCreators</code> ，可以第一个参数传递为 <code>null</code></p><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>$ cnpm i react-redux <span class="token parameter variable">-S</span></pre></td></tr></table></figure><h3 id="1841-创建状态管理器"><a class="anchor" href="#1841-创建状态管理器">#</a> 18.4.1 创建状态管理器</h3><p><code>src/14_redux-react_redux/store.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux'</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">proList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">kindList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">//action  解构了 &#123;type, payload&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">proList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">kindList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><blockquote><p>1. 引入 createStore 方法（新版本中建议使用 rtk）</p><p>2. 创建 reducer（包含初始化状态，包含了修改状态的标识，返回了新的状态（对象合并））</p><p>3. 创建 store</p><p>4. 暴露 store</p></blockquote><h3 id="1842-使用react-redux"><a class="anchor" href="#1842-使用react-redux">#</a> 18.4.2 使用 react-redux</h3><p><code>src/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Provider <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span> <span class="token comment">// 提供 Provier 组件，可以添加 store 属性</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./14_redux_react-redux/store'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./14_redux_react-redux/App'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="13"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>Provider store <span class="token operator">=</span> <span class="token punctuation">&#123;</span> store <span class="token punctuation">&#125;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>使用了 react-redux 提供的组件组件 Provider 配合 store 完成传递数据</p></blockquote><p><code>src/14_redux_react-redux/App.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./Home'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> Kind <span class="token keyword">from</span> <span class="token string">'./Kind'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">redux + react-redux</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Kind</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/14_redux_react-redux/Home.jsx</code> 业务逻辑写到了组件中</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 引入 connect 高阶组件 实际上 connect () 返回值才是高阶组件</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 展示组件   ---- 理想情况：  负责数据的展示以及发起指令</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token comment">// &#123; proList: [], dispatch: function()&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> proList<span class="token punctuation">,</span> dispatch <span class="token punctuation">&#125;</span> <span class="token operator">=</span> props</pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">// 在展示组件内 写业务逻辑</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token comment">// 修改状态</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 依赖项最好 不要直接使用 props，先将 props 进行解构，后添加依赖项</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">//mapStateToProps 负责给展示组件提供数据，提供给展示组件的 props 属性</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">//state 参数即为管理的所有的状态</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 必须含有返回值，返回什么取决于你的展示组件需要什么数据</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token literal-property property">proList</span><span class="token operator">:</span> state<span class="token punctuation">.</span>proList</pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">// 返回的是一个 容器组件  ---- 理想情况： 负责给展示组件提供数据 以及执行 业务逻辑</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/14_redux_react-redux/Kind.jsx</code> 业务逻辑写到容器组件中</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Kind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> kindList<span class="token punctuation">,</span> getKindListData <span class="token punctuation">&#125;</span> <span class="token operator">=</span> props</pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">// 展示组件发起指令，后续交给容器组件处理</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">getKindListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getKindListData<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text">kind</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        kindList <span class="token operator">&amp;&amp;</span> kindList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>          <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token operator">&lt;</span>p key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token literal-property property">kindList</span><span class="token operator">:</span> state<span class="token punctuation">.</span>kindList</pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 将业务逻辑交给容器组件组件处理</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">//dispatch 为默认参数，可以通过此 触发 reducer 中状态的更新</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token function">getKindListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 返回自定义函数，供 展示组件调用，展示组件通过 props 访问即可</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/categorylist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token comment">// 修改状态</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="37"></td><td><pre>          <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>Kind<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>vuex 中 可以把异步操作提取到 vuex 中的 actions 中，react 中异步操作方式会有很多，最常见的就是 redux-thunk</p></blockquote><h2 id="185-reduxreact-redux分模块使用"><a class="anchor" href="#185-reduxreact-redux分模块使用">#</a> 18.5 redux+react-redux 分模块使用</h2><blockquote><p>如果项目很大，或者项目划分比较明确，需要将状态管理器也分模块去处理</p><p>假设现在有一个 home 模块，管理 bannerList 以及 proList</p><p>还有一个模块 kind 模块，管理 kindList</p></blockquote><p><code>src/15_redux_react-redux_combine/store/modules/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 单独管理 home 模块的状态管理器</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">bannerList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">proList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_BANNER_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">bannerList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">proList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> reducer</pre></td></tr></table></figure><p><code>src/15_redux_react-redux_combine/store/modules/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 单独管理 kind 模块的状态管理器</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">kindList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">kindList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> reducer</pre></td></tr></table></figure><blockquote><p>整合多个 reducer 为一个，因为 有一个原则 ： 单一数据源 的原则</p></blockquote><p><code>src/15_redux_react-redux_combine/store/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> combineReducers<span class="token punctuation">,</span> createStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> home <span class="token keyword">from</span> <span class="token string">'./modules/home'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> kind <span class="token keyword">from</span> <span class="token string">'./modules/kind'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  home<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  kind</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><blockquote><p>入口文件处引入状态管理器</p></blockquote><p><code>src/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Provider <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span> <span class="token comment">// 提供 Provier 组件，可以添加 store 属性</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./15_redux_react-redux_combine/store/index'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./15_redux_react-redux_combine/App'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="13"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>Provider store <span class="token operator">=</span> <span class="token punctuation">&#123;</span> store <span class="token punctuation">&#125;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>组件中使用状态管理器</p></blockquote><p><code>src/15_redux_react-redux_combine/App.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./views/Home'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> Kind <span class="token keyword">from</span> <span class="token string">'./views/Kind'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hr</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Kind</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/15_redux_react-redux_combine/views/Home.jsx</code> 业务逻辑在展示型组件中</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList<span class="token punctuation">,</span> dispatch <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/banner/list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_BANNER_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="24"></td><td><pre>          bannerList <span class="token operator">&amp;&amp;</span> bannerList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token operator">&lt;</span>img key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>bannerid <span class="token punctuation">&#125;</span> src<span class="token operator">=</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>img <span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token punctuation">&#123;</span>item<span class="token punctuation">.</span>alt<span class="token punctuation">&#125;</span> style<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">0</span><span class="token operator">--</span><span class="token operator">></span> <span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="26"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token comment">// (state) => (&#123; bannerList: state.home.bannerList, proList: state.home.proList &#125;)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>  <span class="token comment">// (&#123; home &#125;) => (&#123; bannerList: home.bannerList, proList: home.proList &#125;)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token comment">// (&#123; home: &#123; bannerList, proList &#125; &#125;) => (&#123; bannerList: bannerList, proList: proList &#125;)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> <span class="token literal-property property">home</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/15_redux_react-redux_combine/views/Kind.jsx</code> 业务逻辑在容器组件中</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// const Kind = connect(</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//   (&#123; kind: &#123; kindList &#125;&#125;) => (&#123; kindList &#125;), // state => &#123; return &#123; kindList: state.kind.kindList &#125;&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//   (dispatch) => (&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">//     getKindListData () &#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">//       fetch('http://121.89.205.189:3001/api/pro/categorylist').then(res => res.json()).then(res => &#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">//         dispatch(&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//           type: 'CHANGE_KIND_LIST',</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//           payload: res.data</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//         &#125;)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//       &#125;)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//     &#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">//   &#125;)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// )((&#123; kindList, getKindListData &#125;) => &#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">//   useEffect(() => &#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">//     getKindListData()</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">//   &#125;, [getKindListData])</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">//   return (</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">//     &lt;div></span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">//       &lt;h1>Kind&lt;/h1></span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">//       &#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">//         kindList &amp;&amp; kindList.map(item => &#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">//           return (</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">//             &lt;p key = &#123; item &#125;> &#123; item &#125; &lt;/p></span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">//           )</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">//         &#125;)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">//       &#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">//     &lt;/div></span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">//   );</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// &#125;);</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">// export default Kind;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Kind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> kindList<span class="token punctuation">,</span> getKindListData <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token function">getKindListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getKindListData<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Kind</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        kindList <span class="token operator">&amp;&amp;</span> kindList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>          <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token operator">&lt;</span>p key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> kindList <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> kindList <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// state => &#123; return &#123; kindList: state.kind.kindList &#125;&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token function">getKindListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/categorylist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="58"></td><td><pre>          <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">(</span>Kind<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>细心的你发现，虽然展示组件的代码变少了，但是容器组件中还有 异步相关操作，能否把这些异步操作提取出去</p></blockquote><h2 id="186-redux-react-redux-分模块-异步操作"><a class="anchor" href="#186-redux-react-redux-分模块-异步操作">#</a> 18.6 redux + react-redux + 分模块 + 异步操作</h2><blockquote><p>配合 redux 常用的异步模块 为 <code>redux-thunk</code> , <code>redux-saga</code></p></blockquote><h3 id="1861-redux-thunk"><a class="anchor" href="#1861-redux-thunk">#</a> 18.6.1 redux-thunk</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>$ cnpm i redux-thunk <span class="token parameter variable">-S</span></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/modules/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">bannerList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token literal-property property">proList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_BANNER_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">bannerList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">proList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> reducer</pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/modules/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">kindList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">kindList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> reducer</pre></td></tr></table></figure><blockquote><p>整合多个 reducer 为一个，因为 有一个原则 ： 单一数据源 的原则</p><p>并且后续需要使用 异步操作，将异步操作模块 使用进来</p></blockquote><p><code>src/16_redux_react-redux_redux-thunk_combine/store/index.js</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createStore<span class="token punctuation">,</span> combineReducers<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'redux-thunk'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> home <span class="token keyword">from</span> <span class="token string">'./modules/home'</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> kind <span class="token keyword">from</span> <span class="token string">'./modules/kind'</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  home<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  kind</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 第二个参数表示代码中含有异步操作，且异步操作需要提取出 容器组件</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Provider <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span> <span class="token comment">// 提供 Provier 组件，可以添加 store 属性</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./16_redux_react-redux_redux-thunk_combine/store'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./16_redux_react-redux_redux-thunk_combine/App'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="13"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>Provider store <span class="token operator">=</span> <span class="token punctuation">&#123;</span> store <span class="token punctuation">&#125;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Provider</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/App.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./views/Home'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> Kind <span class="token keyword">from</span> <span class="token string">'./views/Kind'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Kind</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>上一个案例 异步操作在组件，现在需要将其放到 异步操作模块中去 actionCreator</p></blockquote><p><code>src/16_redux_react-redux_redux-thunk_combine/api/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getBannerList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/banner/list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getProList</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/list?limitNum='</span> <span class="token operator">+</span> params<span class="token punctuation">.</span>limitNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/api/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getKindList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/categorylist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/actions/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 容器组件抽离的异步操作都写在这里</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 每一个 action 的函数记住一个原则，默认的参数为 dispatch</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 如果接口调用不需要传递参数，直接给函数写默认参数 dispatch</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 如果接口调用需要传递参数，一般在返回一个函数，返回函数的 参数为 dispatch</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getBannerList<span class="token punctuation">,</span> getProList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../../api/home'</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">//actionCreator 本质是一个带有 dispatch 参数的函数</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token function">getBannerListAction</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 因为此接口不需要参数，所有拥有了默认参数 dispatch</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">getBannerList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_BANNER_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token function">getProListAction</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 组件调用需要传递参数</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token function">getProList</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>          <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> action</pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/actions/kind.js</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getKindList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../../api/kind'</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token function">getKindListAction</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">getKindList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> action</pre></td></tr></table></figure><blockquote><p>记住接口有无参数影响 action 的写法，还影响其调用</p></blockquote><p><code>src/16_redux_react-redux_redux-thunk_combine/views/Home.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> action <span class="token keyword">from</span> <span class="token string">'../store/actions/home'</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> Home <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token literal-property property">bannerList</span><span class="token operator">:</span> state<span class="token punctuation">.</span>home<span class="token punctuation">.</span>bannerList<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token literal-property property">proList</span><span class="token operator">:</span> state<span class="token punctuation">.</span>home<span class="token punctuation">.</span>proList</pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">getBannerList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>getBannerListAction<span class="token punctuation">)</span> <span class="token comment">// 因为没有参数，所以不加 ()</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">getProList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span><span class="token function">getProListAction</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">limitNum</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 因为有参数，所以加 ()</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList<span class="token punctuation">,</span> getBannerList<span class="token punctuation">,</span> getProList <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">getBannerList</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">getProList</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getBannerList<span class="token punctuation">,</span> getProList<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">首页</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>          bannerList <span class="token operator">&amp;&amp;</span> bannerList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token operator">&lt;</span>img src <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>img <span class="token punctuation">&#125;</span> key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>bannerid <span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token string">""</span> style<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">1</span><span class="token operator">--</span><span class="token operator">>></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>img</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            <span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Home<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/views/Home.jsx</code> 异步在组件</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// import &#123; getBannerList, getProList &#125; from '../api/home'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> action <span class="token keyword">from</span> <span class="token string">'../store/actions/home'</span> <span class="token comment">// 异步操作</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList<span class="token punctuation">,</span> getBannerListData<span class="token punctuation">,</span> getProListData <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">getBannerListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">getProListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getBannerListData<span class="token punctuation">,</span> getProListData<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="15"></td><td><pre>          bannerList <span class="token operator">&amp;&amp;</span> bannerList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token operator">&lt;</span>img key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>bannerid <span class="token punctuation">&#125;</span> src<span class="token operator">=</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>img <span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token punctuation">&#123;</span>item<span class="token punctuation">.</span>alt<span class="token punctuation">&#125;</span> style<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">2</span><span class="token operator">--</span><span class="token operator">></span> <span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="26"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> <span class="token literal-property property">home</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token function">getBannerListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token comment">// getBannerList().then(res => &#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token comment">//   dispatch(&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token comment">//     type: 'CHANGE_BANNER_LIST',</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token comment">//     payload: res.data</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token comment">//   &#125;)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token comment">// &#125;)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token comment">// 根据生成的 actionCreate 规则去写，午餐不加（）</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>getBannerListAction<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>      </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token function">getProListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>      <span class="token comment">// getProList().then(res => &#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>      <span class="token comment">//   dispatch(&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>      <span class="token comment">//     type: 'CHANGE_PRO_LIST',</span></pre></td></tr><tr><td data-num="49"></td><td><pre>      <span class="token comment">//     payload: res.data</span></pre></td></tr><tr><td data-num="50"></td><td><pre>      <span class="token comment">//   &#125;)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token comment">// &#125;)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span><span class="token function">getProListAction</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">limitNum</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/views/Kind.jsx</code> 异步在 store</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// import &#123; getKindList &#125; from '../api/kind'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> action <span class="token keyword">from</span> <span class="token string">'../store/actions/kind'</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Kind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> kindList<span class="token punctuation">,</span> getKindListData <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">getKindListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getKindListData<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Kind</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        kindList <span class="token operator">&amp;&amp;</span> kindList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>          <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token operator">&lt;</span>p key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> kindList <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> kindList <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token function">getKindListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token comment">// getKindList().then(res => &#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token comment">//   dispatch(&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token comment">//     type: 'CHANGE_KIND_LIST',</span></pre></td></tr><tr><td data-num="30"></td><td><pre>      <span class="token comment">//     payload: res.data</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token comment">//   &#125;)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      <span class="token comment">// &#125;)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>getKindListAction<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">(</span>Kind<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>虽然引入了 redux-thunk，但是仍然可以把 异步放在组件中，具体根据项目的需求而定</p></blockquote><blockquote><p>创建状态模块</p><p>整合模块</p><p>创建异步的 actionCreator</p><p>组件触发 actionCreator</p><p>传递数据以及修改界面</p></blockquote><h3 id="1862-redux-saga"><a class="anchor" href="#1862-redux-saga">#</a> 18.6.2 redux-saga</h3><blockquote><p>先要了解解决异步操作方案：回调函数、promise、async await、generator yield</p></blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9lczYucnVhbnlpZmVuZy5jb20vI2RvY3MvZ2VuZXJhdG9yLWFzeW5j">https://es6.ruanyifeng.com/#docs/generator-async</span></p><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>$ cnpm i redux-saga <span class="token parameter variable">-S</span></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/modules/home.js</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span>  <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">bannerList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">proList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_BANNER_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">bannerList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">proList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> reducer</pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/modules/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">&#123;</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">kindList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">kindList</span><span class="token operator">:</span> payload <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token keyword">return</span> state</pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> reducer</pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/api/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getBannerList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/banner/list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getProList</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/list?limitNum='</span> <span class="token operator">+</span> params<span class="token punctuation">.</span>limitNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/api/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getKindList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/categorylist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/mySaga.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//put 类似 dispatch put (&#123;type: '', payload: ''&#125;) 触发状态的修改</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//call 用来调用数据请求   call (getBannerList)  ===>    getBannerList ()</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//takeLatest 用来响应触发哪一个异步操作</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> put<span class="token punctuation">,</span> call<span class="token punctuation">,</span> takeLatest <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux-saga/effects'</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getBannerList<span class="token punctuation">,</span> getProList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../api/home'</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getKindList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../api/kind'</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 异步操作</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">getBannerListAction</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>getBannerList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'banner'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token comment">// 修改状态</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_BANNER_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">getProListAction</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>getProList<span class="token punctuation">,</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pro'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_PRO_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">getKindListAction</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>getKindList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'kind'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CHANGE_KIND_LIST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">// 定义异步触发的条件</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">mySaga</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token comment">// 组件触发 REQUEST_BANNER 即可执行 getBannerListAction 异步行为</span></pre></td></tr><tr><td data-num="42"></td><td><pre>  <span class="token keyword">yield</span> <span class="token function">takeLatest</span><span class="token punctuation">(</span><span class="token string">'REQUEST_BANNER'</span><span class="token punctuation">,</span> getBannerListAction<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token comment">// 组件触发 REQUEST_PRO 即可执行 getProListAction 异步行为</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token keyword">yield</span> <span class="token function">takeLatest</span><span class="token punctuation">(</span><span class="token string">'REQUEST_PRO'</span><span class="token punctuation">,</span> getProListAction<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>   <span class="token comment">// 组件触发 REQUEST_KIND 即可执行 getKindListAction 异步行为</span></pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token keyword">yield</span> <span class="token function">takeLatest</span><span class="token punctuation">(</span><span class="token string">'REQUEST_KIND'</span><span class="token punctuation">,</span> getKindListAction<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> mySaga</pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/index.js</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createStore<span class="token punctuation">,</span> combineReducers<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> createSagaMiddleWare <span class="token keyword">from</span> <span class="token string">'redux-saga'</span> <span class="token comment">// 导入生成中间件的函数</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> mySaga <span class="token keyword">from</span> <span class="token string">'./mySaga'</span> <span class="token comment">// 异步行为</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 分模块</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> home <span class="token keyword">from</span> <span class="token string">'./modules/home'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> kind <span class="token keyword">from</span> <span class="token string">'./modules/kind'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> home<span class="token punctuation">,</span> kind <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token comment">// 整合 reducer</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">const</span> middleware <span class="token operator">=</span> <span class="token function">createSagaMiddleWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 生成中间件</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>middleware<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 创建状态管理器</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>middleware<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>mySaga<span class="token punctuation">)</span> <span class="token comment">// 中间件使用异步，放到 store 创建之后</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Provider <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span> <span class="token comment">// 提供 Provier 组件，可以添加 store 属性</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./17_redux_react-redux_redux-saga_combine/store/index'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./17_redux_react-redux_redux-saga_combine/App'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="13"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>Provider store <span class="token operator">=</span> <span class="token punctuation">&#123;</span> store <span class="token punctuation">&#125;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/views/Home.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList<span class="token punctuation">,</span> dispatch <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">// 触发某个行为，从而触发 异步操作</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'REQUEST_BANNER'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'REQUEST_PRO'</span><span class="token punctuation">,</span> <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">limitNum</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="15"></td><td><pre>          bannerList <span class="token operator">&amp;&amp;</span> bannerList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token operator">&lt;</span>img key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>bannerid <span class="token punctuation">&#125;</span> src<span class="token operator">=</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>img <span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token punctuation">&#123;</span>item<span class="token punctuation">.</span>alt<span class="token punctuation">&#125;</span> style<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">3</span><span class="token operator">--</span><span class="token operator">></span> <span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="26"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> <span class="token literal-property property">home</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> bannerList<span class="token punctuation">,</span> proList <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/views/Kind.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> connect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Kind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> kindList<span class="token punctuation">,</span> getKindListData <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">getKindListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getKindListData<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Kind</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        kindList <span class="token operator">&amp;&amp;</span> kindList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>          <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token operator">&lt;</span>p key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> kindList <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span>kindList<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">getKindListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'REQUEST_KIND'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">(</span>Kind<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="187-使用immutable不可变数据数据结构"><a class="anchor" href="#187-使用immutable不可变数据数据结构">#</a> 18.7 使用 immutable 不可变数据数据结构</h2><p>immutable 不可变的数据解构，意思就是一旦数据被创建，需要使用特殊的方法进行修改（修改过后的数据也是符合 immutable 数据解构的，他是一个全新的对象）</p><p>学习 immutable： <span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvaW1tdXRhYmxl">https://www.npmjs.com/package/immutable</span></p><pre><code>$ cnpm i immutable redux-immutable -S
</code></pre><p>重点就是修改 reducer 的数据机构以及组件中获取状态的方式（整合 reducer 时使用 redux-immutable 提供的 combineReducers）</p><p>拷贝 17 文件，修改 store/modules/home.js store/modules/kind.js store/index.js</p><p>views/Home.jsx views/Kind.jsx</p><h1 id="十九-redux-toolkit"><a class="anchor" href="#十九-redux-toolkit">#</a> 十九、redux toolkit</h1><p><span class="exturl" data-url="aHR0cHM6Ly9jbi5yZWR1eC5qcy5vcmcv">https://cn.redux.js.org/</span></p><h2 id="191-什么是redux-toolkit"><a class="anchor" href="#191-什么是redux-toolkit">#</a> 19.1 什么是 Redux Toolkit</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jbi5yZWR1eC5qcy5vcmcvcmVkdXgtdG9vbGtpdC9vdmVydmlldy8=">https://cn.redux.js.org/redux-toolkit/overview/</span></p><p><strong><span class="exturl" data-url="aHR0cHM6Ly9yZWR1eC10b29sa2l0LmpzLm9yZy8=">Redux Toolkit</span></strong> 是我们官方的，有观点的，开箱即用的高效 Redux 开发工具集。它旨在成为标准的 Redux 逻辑开发方式，我们强烈建议您使用它。</p><p>它包括几个实用程序功能，这些功能可以简化最常见场景下的 Redux 开发，包括配置 store、定义 reducer，不可变的更新逻辑、甚至可以立即创建整个状态的 “切片 slice”，而无需手动编写任何 action creator 或者 action type。它还包括使用最广泛的 Redux 插件，例如 Redux Thunk 用于异步逻辑，而 Reselect 用于编写选择器 selector 函数，因此你可以立即使用它们。</p><h2 id="192-如何使用redux-toolkit"><a class="anchor" href="#192-如何使用redux-toolkit">#</a> 19.2 如何使用 redux-toolkit</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jbi5yZWR1eC5qcy5vcmcvdHV0b3JpYWxzL3F1aWNrLXN0YXJ0">https://cn.redux.js.org/tutorials/quick-start</span></p><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>$ cnpm i @reduxjs/toolkit redux react-redux redux-devtools <span class="token parameter variable">-S</span></pre></td></tr></table></figure><h3 id="1921-创建状态管理器"><a class="anchor" href="#1921-创建状态管理器">#</a> 19.2.1 创建状态管理器</h3><p><code>src/19_rtk/store/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> configureStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">reducer</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 此处可以设置多模块</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><h3 id="1922-入口文件配置状态管理器"><a class="anchor" href="#1922-入口文件配置状态管理器">#</a> 19.2.2 入口文件配置状态管理器</h3><p><code>src/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Provider <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span> <span class="token comment">// 提供 Provier 组件，可以添加 store 属性</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./19_rtk/store'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./19_rtk/App'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="13"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>Provider store <span class="token operator">=</span> <span class="token punctuation">&#123;</span> store <span class="token punctuation">&#125;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="1923-创建分模块切片"><a class="anchor" href="#1923-创建分模块切片">#</a> 19.2.3 创建分模块切片</h3><p>创建 slice 需要一个字符串名称来标识切片、一个初始 state 以及一个或多个定义了该如何更新 state 的 reducer 函数。slice 创建后 ，我们可以导出 slice 中生成的 Redux action creators 和 reducer 函数。</p><p><code>src/19_rtk/store/modules/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSlice <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 创建 slice 需要一个字符串名称来标识切片、一个初始 state 以及一个或多个定义了该如何更新 state 的 reducer 函数。</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//slice 创建后 ，我们可以导出 slice 中生成的 Redux action creators 和 reducer 函数。</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> homeSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> <span class="token comment">// vuex namespaced: true</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token literal-property property">initialState</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// vuex state</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token literal-property property">bannerList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token literal-property property">proList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">reducers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// vuex mutations</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">changeBannerList</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      state<span class="token punctuation">.</span>bannerList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">changeProList</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      state<span class="token punctuation">.</span>proList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">,</span> homeSlice<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// 每个 case reducer 函数会生成对应的 Action creators</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> changeBannerList<span class="token punctuation">,</span> changeProList <span class="token punctuation">&#125;</span> <span class="token operator">=</span> homeSlice<span class="token punctuation">.</span>actions</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> homeSlice<span class="token punctuation">.</span>reducer <span class="token comment">//redux 时 管理状态都是 reducer</span></pre></td></tr></table></figure><p><code>src/19_rtk/store/modules/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSlice <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> kindSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'kind'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">initialState</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">kindList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">reducers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">changeKindList</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      state<span class="token punctuation">.</span>kindList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> changeKindList <span class="token punctuation">&#125;</span> <span class="token operator">=</span> kindSlice<span class="token punctuation">.</span>actions</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> kindSlice<span class="token punctuation">.</span>reducer</pre></td></tr></table></figure><h3 id="1924-整合切片"><a class="anchor" href="#1924-整合切片">#</a> 19.2.4 <strong>整合切片</strong></h3><p><code>src/19_rtk/store/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> configureStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> home <span class="token keyword">from</span> <span class="token string">'./modules/home'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> kind <span class="token keyword">from</span> <span class="token string">'./modules/kind'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">reducer</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 所有的模块都可以配置到此</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    home<span class="token punctuation">,</span> kind</pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><h3 id="1925-组件中使用状态管理器"><a class="anchor" href="#1925-组件中使用状态管理器">#</a> 19.2.5 组件中使用状态管理器</h3><p><code>src/19_rtk/views/Home.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//useSelector 用来获取状态管理器的状态</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//useDispatch 用来修改状态</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useSelector<span class="token punctuation">,</span> useDispatch <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> changeBannerList<span class="token punctuation">,</span> changeProList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./../store/modules/home'</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getBannerList<span class="token punctuation">,</span> getProList  <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../api/home'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">const</span> bannerList <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>home<span class="token punctuation">.</span>bannerList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">const</span> proList <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>home<span class="token punctuation">.</span>proList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">getBannerList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">changeBannerList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">getProList</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">limitNum</span><span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">changeProList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Home</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="25"></td><td><pre>          bannerList <span class="token operator">&amp;&amp;</span> bannerList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token operator">&lt;</span>img key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>bannerid <span class="token punctuation">&#125;</span> src<span class="token operator">=</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>img <span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token punctuation">&#123;</span>item<span class="token punctuation">.</span>alt<span class="token punctuation">&#125;</span> style<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">4</span><span class="token operator">--</span><span class="token operator">></span> <span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="27"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="30"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Home<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/19_rtk/views/Kind.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getKindList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../api/kind'</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> changeKindList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../store/modules/kind'</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Kind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">const</span> kindList <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>kind<span class="token punctuation">.</span>kindList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token function">getKindList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">changeKindList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Kind</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        kindList <span class="token operator">&amp;&amp;</span> kindList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>          <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token operator">&lt;</span>p key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Kind<span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><ul><li><p>使用 <code>configureStore</code> 创建 Redux store</p><ul><li><code>configureStore</code> 接受 <code>reducer</code> 函数作为命名参数</li><li><code>configureStore</code> 使用的好用的默认设置自动设置 store</li></ul></li><li><p>为 React 应用程序组件提供 Redux store</p><ul><li>使用 React-Redux <code>&lt;Provider&gt;</code> 组件包裹你的 <code>&lt;App /&gt;</code></li><li>传递 Redux store 如 <code>&lt;Provider store=&#123;store&#125;&gt;</code></li></ul></li><li><p>使用 <code>createSlice</code> 创建 Redux &quot;slice&quot; reducer</p><ul><li><p>使用字符串名称、初始状态和命名的 reducers 函数调用 “createSlice”</p></li><li><p>Reducer 函数可以使用 Immer 来 “改变” 状态</p></li><li><p>导出生成的 slice reducer 和 action creators</p></li></ul></li><li><p>在 React 组件中使用 React-Redux <code>useSelector/useDispatch</code> 钩子</p><ul><li><p>使用 <code>useSelector</code> 钩子从 store 中读取数据</p></li><li><p>使用 <code>useDispatch</code> 钩子获取 <code>dispatch</code> 函数，并根据需要 dispatch actions</p></li></ul></li></ul></blockquote><blockquote><p>此时发现，组件中的异步操作在 组件内部调用，接下来需要研究如何将异步操作从组件提取出来</p></blockquote><h2 id="193-提取异步操作"><a class="anchor" href="#193-提取异步操作">#</a> 19.3 提取异步操作</h2><h3 id="1931-自己定义请求函数"><a class="anchor" href="#1931-自己定义请求函数">#</a> 19.3.1 自己定义请求函数</h3><p><code>src/20_rtk_async/api/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getBannerList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/banner/list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getProList</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/list?limitNum='</span> <span class="token operator">+</span> params<span class="token punctuation">.</span>limitNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>src/20_rtk_async/api/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getKindList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://121.89.205.189:3001/api/pro/categorylist'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>src/20_rtk_async/store/modules/home.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSlice <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getBannerList<span class="token punctuation">,</span> getProList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../../api/home'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> homeSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token comment">// 主要定义模块，后期从模块中取值给组件以及整合状态管理器</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> <span class="token comment">// 模块名称</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">initialState</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 模块代表的初始化状态</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">bannerList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token literal-property property">proList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token literal-property property">reducers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 修改状态</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">changeBannerList</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      state<span class="token punctuation">.</span>bannerList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">changeProList</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      state<span class="token punctuation">.</span>proList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 取得数据之后，只需要 dispatch 触发此函数即可，参数即为修改时用的 action 的值</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> changeBannerList<span class="token punctuation">,</span> changeProList <span class="token punctuation">&#125;</span> <span class="token operator">=</span> homeSlice<span class="token punctuation">.</span>actions</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// 如果异步操作在状态管理器，写如下代码，参照 redux-thunk 写法</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getBannerListAction</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//dispatch 为默认参数</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token function">getBannerList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">changeBannerList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getProListAction</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">//dispatch 为默认参数</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token function">getProList</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">changeProList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> homeSlice<span class="token punctuation">.</span>reducer</pre></td></tr></table></figure><p><code>src/20_rtk_async/store/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> configureStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> home <span class="token keyword">from</span> <span class="token string">'./modules/home'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">reducer</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    home</pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> store</pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// src/index.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入状态管理器</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Provider <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span> <span class="token comment">// 提供 Provier 组件，可以添加 store 属性</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./20_rtk_async/store'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./20_rtk_async/App'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 标签形式调用</span></pre></td></tr><tr><td data-num="13"></td><td><pre>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>Provider store <span class="token operator">=</span> <span class="token punctuation">&#123;</span> store <span class="token punctuation">&#125;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>src/20_rtk_async/App.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./views/Home'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> Kind <span class="token keyword">from</span> <span class="token string">'./views/Kind'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Kind</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>src/20_rtk_async/views/Home.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getBannerListAction<span class="token punctuation">,</span> getProListAction <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../store/modules/home'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">const</span> bannerList <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>home<span class="token punctuation">.</span>bannerList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">const</span> proList <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>home<span class="token punctuation">.</span>proList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token function">dispatch</span><span class="token punctuation">(</span>getBannerListAction<span class="token punctuation">)</span> <span class="token comment">// 无参不加（）</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">getProListAction</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">limitNum</span><span class="token operator">:</span> <span class="token number">8</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 有参加（）</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Home20</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>          bannerList <span class="token operator">&amp;&amp;</span> bannerList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token operator">&lt;</span>img key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>bannerid <span class="token punctuation">&#125;</span> src<span class="token operator">=</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>img <span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token punctuation">&#123;</span>item<span class="token punctuation">.</span>alt<span class="token punctuation">&#125;</span> style<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>swig￼<span class="token number">5</span><span class="token operator">--</span><span class="token operator">></span> <span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="22"></td><td><pre>          <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>          proList <span class="token operator">&amp;&amp;</span> proList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>li key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proid <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>proname <span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Home<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="1932-使用-createasyncthunk-请求数据"><a class="anchor" href="#1932-使用-createasyncthunk-请求数据">#</a> 19.3.2 使用 <code>createAsyncThunk</code> 请求数据</h3><p>Redux Toolkit 的 <code>createAsyncThunk</code> API 生成 thunk，为您自动 dispatch 那些 &quot;start/success/failure&quot; action。</p><p><code>src/20_rtk_async/store/modules/kind.js</code></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSlice<span class="token punctuation">,</span> createAsyncThunk <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getKindList <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./../../api//kind'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> kindSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'kind'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">initialState</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">kindList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">reducers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">changeKindList</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 如果使用了 createAsyncThunk 此处修改状态失效</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      state<span class="token punctuation">.</span>kindList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token function-variable function">extraReducers</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">//createAsyncThunk 在这里修改状态 下面可以看作固定的写法</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    builder</pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">addCase</span><span class="token punctuation">(</span>getKindListAction<span class="token punctuation">.</span>pending<span class="token punctuation">,</span> <span class="token parameter">state</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        state<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">'loading'</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">addCase</span><span class="token punctuation">(</span>getKindListAction<span class="token punctuation">.</span>fulfilled<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        state<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">'idle'</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        state<span class="token punctuation">.</span>kindList <span class="token operator">=</span> action<span class="token punctuation">.</span>payload</pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">addCase</span><span class="token punctuation">(</span>getKindListAction<span class="token punctuation">.</span>rejected<span class="token punctuation">,</span> <span class="token parameter">state</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        state<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">'failed'</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">//kind/getKindListAction1123 可以自定义，但是最好有意义</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> getKindListAction <span class="token operator">=</span> <span class="token function">createAsyncThunk</span><span class="token punctuation">(</span><span class="token string">'kind/getKindListAction1123'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'num'</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getKindList</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token keyword">return</span> res<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> changeKindList <span class="token punctuation">&#125;</span> <span class="token operator">=</span> kindSlice<span class="token punctuation">.</span>actions</pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> kindSlice<span class="token punctuation">.</span>reducer</pre></td></tr></table></figure><p><code>src/20_rtk_async/views/Kind.jsx</code></p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useEffect <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> getKindListAction <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'../store/modules/kind'</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">Kind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">const</span> kindList <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>kind<span class="token punctuation">.</span>kindList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">getKindListAction</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Kind20</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        kindList <span class="token operator">&amp;&amp;</span> kindList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token keyword">return</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token operator">&lt;</span>p key <span class="token operator">=</span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span> item <span class="token punctuation">&#125;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token plain-text"></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> Kind<span class="token punctuation">;</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/react/" rel="tag"><i class="ic i-tag"></i> react</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-10-31 10:21:23" itemprop="dateModified" datetime="2022-10-31T10:21:23+08:00">2022-10-31</time> </span><span id="react-study/8/" class="item leancloud_visitors" data-flag-title="React学习第八天" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 联系我</button><p>来交朋友吧！</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="叶星辰 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="叶星辰 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="叶星辰 QQ"><p>QQ</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>叶星辰 <i class="ic i-at"><em>@</em></i>永不陨落的星辰</li><li class="link"><strong>本文链接：</strong> <a href="https://www.yexingcheng.com/react-study/8/" title="React学习第八天">https://www.yexingcheng.com/react-study/8/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/react-study/7/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipetlbztpj20zk0m84qp.jpg" title="React学习第七天"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> react学习</span><h3>React学习第七天</h3></a></div><div class="item right"><a href="/interface/interview/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giph4fomxoj20zk0m8axp.jpg" title="面试题总结"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 面试用</span><h3>面试题总结</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AB-redux"><span class="toc-number">1.</span> <span class="toc-text">十八、Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#181-%E7%90%86%E8%A7%A3flux%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">18.1 理解 Flux 架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#182-%E7%90%86%E8%A7%A3redux%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">18.2 理解 Redux 单向数据流流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#183-redux%E4%BD%BF%E7%94%A8%E4%B8%89%E5%A4%A7%E5%8E%9F%E5%88%99"><span class="toc-number">1.3.</span> <span class="toc-text">18.3 redux 使用三大原则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#184-redux-react-redux%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">18.4 redux + react-redux 配合使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1841-%E5%88%9B%E5%BB%BA%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">1.4.1.</span> <span class="toc-text">18.4.1 创建状态管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1842-%E4%BD%BF%E7%94%A8react-redux"><span class="toc-number">1.4.2.</span> <span class="toc-text">18.4.2 使用 react-redux</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#185-reduxreact-redux%E5%88%86%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8"><span class="toc-number">1.5.</span> <span class="toc-text">18.5 redux+react-redux 分模块使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#186-redux-react-redux-%E5%88%86%E6%A8%A1%E5%9D%97-%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">1.6.</span> <span class="toc-text">18.6 redux + react-redux + 分模块 + 异步操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1861-redux-thunk"><span class="toc-number">1.6.1.</span> <span class="toc-text">18.6.1 redux-thunk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1862-redux-saga"><span class="toc-number">1.6.2.</span> <span class="toc-text">18.6.2 redux-saga</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#187-%E4%BD%BF%E7%94%A8immutable%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%95%B0%E6%8D%AE%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.7.</span> <span class="toc-text">18.7 使用 immutable 不可变数据数据结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B9%9D-redux-toolkit"><span class="toc-number">2.</span> <span class="toc-text">十九、redux toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#191-%E4%BB%80%E4%B9%88%E6%98%AFredux-toolkit"><span class="toc-number">2.1.</span> <span class="toc-text">19.1 什么是 Redux Toolkit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#192-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8redux-toolkit"><span class="toc-number">2.2.</span> <span class="toc-text">19.2 如何使用 redux-toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1921-%E5%88%9B%E5%BB%BA%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">19.2.1 创建状态管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1922-%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">2.2.2.</span> <span class="toc-text">19.2.2 入口文件配置状态管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1923-%E5%88%9B%E5%BB%BA%E5%88%86%E6%A8%A1%E5%9D%97%E5%88%87%E7%89%87"><span class="toc-number">2.2.3.</span> <span class="toc-text">19.2.3 创建分模块切片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1924-%E6%95%B4%E5%90%88%E5%88%87%E7%89%87"><span class="toc-number">2.2.4.</span> <span class="toc-text">19.2.4 整合切片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1925-%E7%BB%84%E4%BB%B6%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">2.2.5.</span> <span class="toc-text">19.2.5 组件中使用状态管理器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#193-%E6%8F%90%E5%8F%96%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.</span> <span class="toc-text">19.3 提取异步操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1931-%E8%87%AA%E5%B7%B1%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.1.</span> <span class="toc-text">19.3.1 自己定义请求函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1932-%E4%BD%BF%E7%94%A8-createasyncthunk-%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.2.</span> <span class="toc-text">19.3.2 使用 createAsyncThunk 请求数据</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/react-study/1/" rel="bookmark" title="React学习第一天">React学习第一天</a></li><li><a href="/react-study/2/" rel="bookmark" title="React学习第二天">React学习第二天</a></li><li><a href="/react-study/3/" rel="bookmark" title="React学习第三天">React学习第三天</a></li><li><a href="/react-study/4/" rel="bookmark" title="React学习第四天">React学习第四天</a></li><li><a href="/react-study/5/" rel="bookmark" title="React学习第五天">React学习第五天</a></li><li><a href="/react-study/6/" rel="bookmark" title="React学习第六天">React学习第六天</a></li><li><a href="/react-study/7/" rel="bookmark" title="React学习第七天">React学习第七天</a></li><li class="active"><a href="/react-study/8/" rel="bookmark" title="React学习第八天">React学习第八天</a></li><li><a href="/react-study/react-router-params/" rel="bookmark" title="React路由传参的几种方式">React路由传参的几种方式</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="叶星辰" data-src="/images/avatar.jpg"><p class="name" itemprop="name">叶星辰</p><div class="description" itemprop="description">温柔正确的人总是难以生存，因为这个世界既不温柔 也不正确</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">28</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">5</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">11</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NhMW1EMHduMQ==" title="https:&#x2F;&#x2F;github.com&#x2F;Ca1mD0wn1"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9VZmRIbw==" title="https:&#x2F;&#x2F;twitter.com&#x2F;UfdHo"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9tZW5nLXhpbmcteW91LWppLXNpLXl1ZS1odWFuZy0yNw==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;meng-xing-you-ji-si-yue-huang-27"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTUwMjkxOTQ0NQ==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;502919445"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NTc4MjU1ODg1" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7578255885"><i class="ic i-weibo"></i></span> <span class="exturl item email" data-url="aHR0cHM6Ly9tYWlsLmdvb2dsZS5jb20vbWFpbC91LzAvI2luYm94" title="https:&#x2F;&#x2F;mail.google.com&#x2F;mail&#x2F;u&#x2F;0&#x2F;#inbox"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/react-study/7/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/interface/interview/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/vue-mobile/" title="分类于 vue3移动端项目开发">vue3移动端项目开发</a></div><span><a href="/vue-mobile/10/" title="vue-mobile项目开发流程第十部分(构建joinshopcar页面)">vue-mobile项目开发流程第十部分(构建joinshopcar页面)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/react-study/" title="分类于 react学习">react学习</a></div><span><a href="/react-study/3/" title="React学习第三天">React学习第三天</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/react-study/" title="分类于 react学习">react学习</a></div><span><a href="/react-study/1/" title="React学习第一天">React学习第一天</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer/" title="分类于 计算机相关">计算机相关</a></div><span><a href="/computer/rightPointNewMd/" title="如何在右键菜单下添加一个新建markdown文件选项">如何在右键菜单下添加一个新建markdown文件选项</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/react-study/" title="分类于 react学习">react学习</a></div><span><a href="/react-study/react-router-params/" title="React路由传参的几种方式">React路由传参的几种方式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vue-mobile/" title="分类于 vue3移动端项目开发">vue3移动端项目开发</a></div><span><a href="/vue-mobile/5/" title="vue-mobile项目开发流程第五部分(封装数据请求)">vue-mobile项目开发流程第五部分(封装数据请求)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vue-mobile/" title="分类于 vue3移动端项目开发">vue3移动端项目开发</a></div><span><a href="/vue-mobile/1/" title="vue-mobile项目开发流程第一部分(项目搭建和技术栈选择)">vue-mobile项目开发流程第一部分(项目搭建和技术栈选择)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/react-study/" title="分类于 react学习">react学习</a></div><span><a href="/react-study/7/" title="React学习第七天">React学习第七天</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vue-mobile/" title="分类于 vue3移动端项目开发">vue3移动端项目开发</a></div><span><a href="/vue-mobile/13/" title="vue-mobile项目开发流程第十三部分(实现提交订单功能)">vue-mobile项目开发流程第十三部分(实现提交订单功能)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vue-mobile/" title="分类于 vue3移动端项目开发">vue3移动端项目开发</a></div><span><a href="/vue-mobile/11/" title="vue-mobile项目开发流程第十一部分(实现shopcar功能)">vue-mobile项目开发流程第十一部分(实现shopcar功能)</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2021 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">叶星辰 @ 永不陨落的星辰</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">499k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:34</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"react-study/8/",favicon:{show:"星辰",hide:"你快回来"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({model:{jsonPath:"/live2dw/assets/miku.model.json"},display:{position:"right",width:250,height:500},mobile:{show:!1},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html><!-- rebuild by hrmmi -->